{"version":3,"sources":["webpack:///src/app/cart/cart.page.html","webpack:///src/app/cart/cart-routing.module.ts","webpack:///src/app/cart/cart.module.ts","webpack:///src/app/cart/cart.page.scss","webpack:///src/app/cart/cart.page.ts"],"names":["routes","path","component","CartPageRoutingModule","imports","forChild","exports","CartPageModule","declarations","Storage","CartPage","apiService","loadingController","alertController","authService","router","products","history","state","total","i","length","parseFloat","pRCCOMPRA","replace","quantity","p","iD","splice","remove","key","set","value","JSON","stringify","create","message","translucent","loading","present","lines","push","order","sendOrder","subscribe","response","console","log","error","status","logout","dismiss","header","subHeader","buttons","alert","navigateByUrl","replaceUrl","selector","template","providers"],"mappings":"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","file":"cart-cart-module-es5.js","sourcesContent":["export default \"<ion-header [translucent]=\\\"true\\\">\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button></ion-back-button>\\n    </ion-buttons>\\n    <ion-title>Carrito</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <ion-list *ngIf=\\\"products\\\">\\n    <ion-list-header>\\n      Pedido\\n    </ion-list-header>\\n\\n    <ion-item-sliding *ngFor=\\\"let p of products.products\\\">\\n      <ion-item-options side=\\\"start\\\">\\n        <ion-item-option color=\\\"danger\\\" (click)=\\\"remove(p)\\\"><ion-icon style=\\\"zoom:1.5;\\\" name=\\\"trash-outline\\\"></ion-icon></ion-item-option>\\n      </ion-item-options>\\n    <ion-item>\\n      <ion-thumbnail slot=\\\"start\\\">\\n        <ion-img\\n          src=\\\"https://rockcontent.com/es/wp-content/uploads/2019/02/o-que-e-produto-no-mix-de-marketing-1280x720.png\\\">\\n        </ion-img>\\n      </ion-thumbnail>\\n      <ion-label>\\n        <h2>{{p.aRTALIAS}}</h2>\\n        <h3>{{p.dESCART}}</h3>\\n        <p>x{{p.quantity}}</p>\\n      </ion-label>\\n      <div slot=\\\"end\\\">\\n        <h2>{{p.pRCCOMPRA}}€</h2>\\n      </div>\\n    </ion-item>\\n    </ion-item-sliding>\\n    <ion-item>\\n      <h3>Total:</h3>\\n      <div slot=\\\"end\\\">\\n        <h2>{{getTotal() | number : '1.2-2'}}€</h2>\\n      </div>\\n    </ion-item>\\n  </ion-list>\\n\\n  <ion-radio-group value=\\\"credito\\\">\\n    <ion-list-header>\\n      <ion-label>Forma de pago</ion-label>\\n    </ion-list-header>\\n\\n    <ion-item>\\n      <ion-label>Crédito</ion-label>\\n      <ion-radio slot=\\\"start\\\" value=\\\"credito\\\"></ion-radio>\\n    </ion-item>\\n\\n    <ion-item>\\n      <ion-label>Efectivo</ion-label>\\n      <ion-radio slot=\\\"start\\\" value=\\\"efectivo\\\"></ion-radio>\\n    </ion-item>\\n\\n  </ion-radio-group>\\n\\n  <ion-list>\\n    <ion-list-header>Envio</ion-list-header>\\n    <ion-item>\\n      <ion-label>Pedido urgente</ion-label>\\n      <ion-checkbox color=\\\"primary\\\" checked slot=\\\"start\\\"></ion-checkbox>\\n    </ion-item>\\n  </ion-list>\\n  <ion-button [disabled]=\\\"products.products.length == 0\\\" (click)=\\\"sendOrder()\\\" shape=\\\"round\\\" expand=\\\"block\\\">Pedir</ion-button>\\n</ion-content>\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { CartPage } from './cart.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: CartPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class CartPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { CartPageRoutingModule } from './cart-routing.module';\n\nimport { CartPage } from './cart.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    CartPageRoutingModule\n  ],\n  declarations: [CartPage]\n})\nexport class CartPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2NhcnQvY2FydC5wYWdlLnNjc3MifQ== */\";","import { Component, OnInit } from '@angular/core';\nimport { Plugins } from '@capacitor/core';\nimport { ApiService } from '../services/api.service';\nimport { LoadingController } from '@ionic/angular';\nimport { AlertController } from '@ionic/angular';\nimport { AuthenticationService } from '../services/authentication.service';\nimport { Router } from '@angular/router';\n\nconst { Storage } = Plugins;\n@Component({\n  selector: 'app-cart',\n  templateUrl: './cart.page.html',\n  styleUrls: ['./cart.page.scss'],\n  providers: [ApiService]\n})\nexport class CartPage implements OnInit {\n  public products;\n  constructor(\n    private apiService: ApiService,\n    public loadingController: LoadingController,\n    public alertController: AlertController,\n    private authService: AuthenticationService,\n    private router: Router) { }\n\n  ngOnInit() {\n    this.products = history.state\n  }\n\n  getTotal() {\n    var total = 0;\n    for (let i = 0; i < this.products.products.length; i++) {\n      total += parseFloat(this.products.products[i].pRCCOMPRA.replace(/,/, '.')) * this.products.products[i].quantity;\n    }\n    return total;\n  }\n\n  async remove(p){\n    for (var i = 0; i < this.products.products.length; i++) {\n      if (this.products.products[i].iD == p.iD) {\n        this.products.products.splice(i, 1);\n        await Storage.remove({ key: 'PRODUCTS' });\n        Storage.set({ key: 'PRODUCTS', value: JSON.stringify(this.products.products) })\n        break;\n      }\n    }\n  }\n\n  async sendOrder(){\n    const loading = await this.loadingController.create({\n      message: 'Cargando...',\n      translucent: true,\n    });\n    await loading.present();\n    let lines = [];\n    for (let i = 0; i <  this.products.products.length; i++) {\n      lines.push(this.products.products)\n      lines\n      \n    }\n    let order = [{ \n      \"FECHA\": \"01/09/2020\", \n      \"CODCLI\": \"1\", \n      \"CODALM\": \"1\", \n      \"ESTADO\": \"AC\", \n      \"FECENTREGA\": \"02/09/2020\", \n      \"SITUACION\": \"A\", \n      \"lineas\": [{ lines\n         }] \n        }];\n    (await this.apiService.sendOrder(order)).subscribe(\n      (response) => {\n        console.log(response);\n        \n      }, async (error) => {\n        console.log(error)\n        if (error.status === 401) {\n          this.logout();\n          this.loadingController.dismiss();\n        } else {\n          const alert = await this.alertController.create({\n            header: 'Error',\n            subHeader: 'Parece que hay problemas',\n            buttons: ['OK']\n          });\n          await alert.present();\n        }\n      }\n    )\n  }\n\n  async logout() {\n    await this.authService.logout();\n    this.router.navigateByUrl('/', { replaceUrl: true });\n  }\n\n}\n"]}